USER FUNCTION CHECATF()
USE CTASINV ALIAS CTA NEW exclusive
INDE ON CONTA TO CTASINV
USE CCINV ALIAS CC new exclusive
INDE ON CC TO CCINV
DBSELECTAREA("SN3")
DBSETORDER(0)
DBGOTOP()
DO WHILE !EOF()
	DBSELECTAREA("SI1")
	DBSEEK(XFILIAL()+SN3->N3_CCONTAB)
	IF !FOUND()
		DBSELECTAREA("CTA")
		DBSEEK(SN3->N3_CCONTAB)
		IF !FOUND()
			RECLOCK("CTA",.T.)
			CTA->CONTA:= SN3->N3_CCONTAB
			MSUNLOCK("CTA")
		endif
	ENDIF
	DBSELECTAREA("SI1")
	DBSEEK(XFILIAL()+SN3->N3_CDEPREC)
	IF !FOUND()
		DBSELECTAREA("CTA")
		DBSEEK(SN3->N3_Cdeprec)
		IF !FOUND()
			RECLOCK("CTA",.T.)
			CTA->CONTA:= SN3->N3_CDEPREC
			MSUNLOCK("CTA")
		endif
	ENDIF
	DBSELECTAREA("SI1")
	DBSEEK(XFILIAL()+SN3->N3_CCDEPR)
	IF !FOUND()
		DBSELECTAREA("CTA")
		DBSEEK(SN3->N3_CCdepr)
		IF !FOUND()
			RECLOCK("CTA",.T.)
			CTA->CONTA:= SN3->N3_CCDEPR
			MSUNLOCK("CTA")
		ENDIF
	endif
	DBSELECTAREA("SI3")
	DBSEEK(XFILIAL()+SN3->N3_CCUSTO)
	IF !FOUND()
		DBSELECTAREA("CC")
		DBSEEK(SN3->N3_Ccusto)
		IF !FOUND()
			RECLOCK("CC",.T.)
			Cc->CC:= SN3->N3_CCUSTO
			MSUNLOCK("Cc")
		endif
	ENDIF
	DBSELECTAREA("SI3")
	DBSEEK(XFILIAL()+SN3->N3_CUSTBEM)
	IF !FOUND()
		DBSELECTAREA("CC")
		DBSEEK(SN3->N3_Custbem)
		IF !FOUND()
			RECLOCK("CC",.T.)
			Cc->CC:= SN3->N3_CUSTBEM
			MSUNLOCK("Cc")
		endif
	ENDIF
	DBSELECTAREA("SN3")
	DBSKIP()
ENDDO

DBSELECTAREA("SN4")
DBSETORDER(0)
DBGOTOP()
DO WHILE !EOF()
	DBSELECTAREA("SI1")
	DBSEEK(XFILIAL()+SN4->N4_CONTA)
	IF !FOUND()
		DBSELECTAREA("CTA")
		DBSEEK(SN4->N4_CONTA)
		IF !FOUND()
			RECLOCK("CTA",.T.)
			CTA->CONTA:= SN4->N4_CONTA
			MSUNLOCK("CTA")
		ENDIF
	endif
	DBSELECTAREA("SI3")
	DBSEEK(XFILIAL()+SN4->N4_cCUSTo)
	IF !FOUND()
		DBSELECTAREA("CC")
		DBSEEK(SN4->N4_cCusto)
		IF !FOUND()
			RECLOCK("CC",.T.)
			Cc->CC:= SN4->N4_CcUSTo
			MSUNLOCK("Cc")
		endif
	ENDIF
	DBSELECTAREA("SI3")
	DBSEEK(XFILIAL()+SN4->N4_local)
	IF !FOUND()
		DBSELECTAREA("CC")
		DBSEEK(SN4->N4_local)
		IF !FOUND()
			RECLOCK("CC",.T.)
			Cc->CC:= SN4->N4_local
			MSUNLOCK("Cc")
		endif
	ENDIF
	DBSELECTAREA("SN4")
	DBSKIP()
ENDDO

DBSELECTAREA("SN5")
DBSETORDER(0)
DBGOTOP()
DO WHILE !EOF()
	DBSELECTAREA("SI1")
	DBSEEK(XFILIAL()+SN5->N5_CONTA)
	IF !FOUND()
		DBSELECTAREA("CTA")
		DBSEEK(SN5->N5_CONTA)
		IF !FOUND()
			RECLOCK("CTA",.T.)
			CTA->CONTA:= SN5->N5_CONTA
			MSUNLOCK("CTA")
		ENDIF
	endif
	DBSELECTAREA("SN5")
	DBSKIP()
ENDDO