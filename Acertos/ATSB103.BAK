#include "rwmake.ch"        // incluido pelo assistente de conversao do AP5 IDE em 30/03/02

User Function ATSB103()
SetPrvt("CINDEX,CKEY,MCONTA,MGRUPO")
lEnd  := .F.
bBloco:= {|lEnd| ATproc(@lEnd)}
Processa( bBloco, "Aguarde" ,"Processando...", .T. )  

Return

Static Function ATproc()   

DbSelectArea("SB1") 
ProcRegua(LastRec())
DBGOTOP()
DO WHILE .NOT. EOF() .AND. SM0->M0_CODIGO=='03'  
   IncProc("COD: "+B1_COD+" ATUALIZANDO : "+StrZero(RECNO(),7))
   MCONTA:=" "                 
   IF SUBSTR(B1_COD,1,4)=='3410'
      MCONTA:='31010114001'
   ENDIF
   IF SUBSTR(B1_COD,1,4)=='3420'
      MCONTA:='31010114008'
   ENDIF    
   IF SUBSTR(B1_COD,1,4)=='3430
      MCONTA:='31010114007'
   ENDIF
   IF SUBSTR(B1_COD,1,4)=='3450'
      MCONTA:='31010114005'
   ENDIF
   IF SUBSTR(B1_COD,1,4)=='3210'
      MCONTA:='31010113001'
   ENDIF
   IF SUBSTR(B1_COD,1,4)=='3220'
      MCONTA:='31010113003'
   ENDIF
   IF SUBSTR(B1_COD,1,4)=='3230'
      MCONTA:='31010113005'
   ENDIF
   IF SUBSTR(B1_COD,1,4)=='3240'
      MCONTA:='31010113006'
   ENDIF
   IF SUBSTR(B1_COD,1,4)=='3250'
      MCONTA:='31010113007'
   ENDIF
   IF SUBSTR(B1_COD,1,4)=='3260'
      MCONTA:='31010113009'
   ENDIF
   IF SUBSTR(B1_COD,1,4)=='3270'
      MCONTA:='31010113010'
   ENDIF
   IF SUBSTR(B1_COD,1,4)=='3280'
      MCONTA:='31010113011'
   ENDIF
   IF SUBSTR(B1_COD,1,4)=='3290'
      MCONTA:='31010113012'
   ENDIF
   IF SUBSTR(B1_COD,1,4)=='3300'
      MCONTA:='31010113013'
   ENDIF
   IF SUBSTR(B1_COD,1,4)=='3320'
      MCONTA:='31010113008'
   ENDIF
   IF SUBSTR(B1_COD,1,4)=='3440'
      MCONTA:='31010114002'
   ENDIF  
   
   IF SUBSTR(B1_COD,1,4)=='3530'
      MCONTA:='31010115003'
   ENDIF
   
   IF SUBSTR(B1_COD,1,4)=='3610'
      MCONTA:='31010116001'
   ENDIF
   IF SUBSTR(B1_COD,1,4)=='3620'
      MCONTA:='31010116002'
   ENDIF
   IF SUBSTR(B1_COD,1,4)=='3630'
      MCONTA:='31010116004'
   ENDIF
   IF SUBSTR(B1_COD,1,2)=='37'
      MCONTA:='31010117002'
   ENDIF
   IF SUBSTR(B1_COD,1,4)=='3510'
      MCONTA:='31010115001'
   ENDIF
   IF SUBSTR(B1_COD,1,4)=='3520'
      MCONTA:='31010115002'
   ENDIF
   IF SUBSTR(B1_COD,1,4)=='3540'
      MCONTA:='31010115004'
   ENDIF
   IF SUBSTR(B1_COD,1,4)=='3110'
      MCONTA:='31010112001'
   ENDIF
   IF SUBSTR(B1_COD,1,4)=='3120'
      MCONTA:='31010112002'
   ENDIF
   IF SUBSTR(B1_COD,1,4)=='3130'
      MCONTA:='31010112003'
   ENDIF
   IF SUBSTR(B1_COD,1,4)=='3140'
      MCONTA:='31010112005'
   ENDIF
   IF SUBSTR(B1_COD,1,4)=='3150'
      MCONTA:='31010112006'
   ENDIF
   IF SUBSTR(B1_COD,1,4)=='3160'
      MCONTA:='31010112004'
   ENDIF
   IF SUBSTR(B1_COD,1,4)=='3800'
      MCONTA:='41020406003'
   ENDIF  
   
   IF SUBSTR(B1_COD,1,2)=='22'
      MCONTA:='31010113008'
   ENDIF  
   
   IF SUBSTR(B1_COD,1,2)=='01' .OR.SUBSTR(B1_COD,1,2)=='06' .OR.SUBSTR(B1_COD,1,2)=='05' .OR.;
      SUBSTR(B1_COD,1,2)=='07' .OR.SUBSTR(B1_COD,1,2)=='09' .OR.SUBSTR(B1_COD,1,2)=='10'
      MCONTA:='31010117002'
   ENDIF   
   
   
   RECLOCK('SB1',.F.)
   REPLA B1_CONTA WITH MCONTA
   MSUNLOCK()
   DBSKIP()
ENDDO
DbSelectArea("SB1")
Retindex("SB1")
Return
